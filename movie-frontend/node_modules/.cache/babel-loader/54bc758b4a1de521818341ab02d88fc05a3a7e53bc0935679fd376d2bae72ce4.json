{"ast":null,"code":"import _objectSpread from\"/data/data/com.termux/files/home/Movie_Recommendation_App/movie-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useContext}from'react';import api,{setAuthToken}from'../services/api';import AuthContext from'../context/AuthContext';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function MovieList(){const[movies,setMovies]=useState([]);const[editingId,setEditingId]=useState(null);const[editForm,setEditForm]=useState({title:'',genre:''});const[loading,setLoading]=useState(false);const[message,setMessage]=useState('');const{token,logout}=useContext(AuthContext);const navigate=useNavigate();useEffect(()=>{if(token){setAuthToken(token);fetchMovies();}else{navigate('/login');}},[token]);const fetchMovies=async()=>{setLoading(true);try{const res=await api.get('/movies/all');setMovies(res.data.movies||[]);}catch(_unused){setMessage('Failed to fetch movies');}finally{setLoading(false);}};const handleDelete=async id=>{if(!window.confirm('Delete this movie?'))return;try{await api.delete(\"/movies/\".concat(id));setMovies(movies.filter(m=>m._id!==id));setMessage('Movie deleted successfully');}catch(_unused2){setMessage('Delete failed');}};const startEdit=movie=>{setEditingId(movie._id);setEditForm({title:movie.title,genre:movie.genre});};const cancelEdit=()=>{setEditingId(null);setEditForm({title:'',genre:''});setMessage('');};const handleUpdate=async e=>{e.preventDefault();setLoading(true);try{await api.put(\"/movies/\".concat(editingId),editForm);setMovies(movies.map(m=>m._id===editingId?_objectSpread(_objectSpread({},m),editForm):m));cancelEdit();setMessage('Movie updated');}catch(_unused3){setMessage('Update failed');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Movie List\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dashboard'),children:\"Back to Dashboard\"}),message&&/*#__PURE__*/_jsx(\"p\",{children:message}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}),/*#__PURE__*/_jsx(\"ul\",{children:movies.map(movie=>/*#__PURE__*/_jsx(\"li\",{style:{marginBottom:'1rem'},children:editingId===movie._id?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpdate,style:{display:'inline'},children:[/*#__PURE__*/_jsx(\"input\",{value:editForm.title,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{title:e.target.value})),required:true}),/*#__PURE__*/_jsx(\"input\",{value:editForm.genre,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{genre:e.target.value})),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelEdit,children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"strong\",{children:movie.title}),\" \\u2014 \",movie.genre,/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'0.3rem'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEdit(movie),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(movie._id),children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const link=\"\".concat(window.location.origin,\"/movie/\").concat(movie._id);navigator.clipboard.writeText(link);alert('Link copied!');},style:{marginLeft:'8px',color:'blue',textDecoration:'underline'},children:\"Share\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const embedCode=\"<iframe src=\\\"\".concat(window.location.origin,\"/movie/\").concat(movie._id,\"\\\" width=\\\"600\\\" height=\\\"400\\\" frameborder=\\\"0\\\" allowfullscreen></iframe>\");navigator.clipboard.writeText(embedCode);alert('Embed code copied!');},style:{marginLeft:'8px',color:'green',textDecoration:'underline'},children:\"Copy Embed Code\"})]})]})},movie._id))})]});}","map":{"version":3,"names":["React","useEffect","useState","useContext","api","setAuthToken","AuthContext","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MovieList","movies","setMovies","editingId","setEditingId","editForm","setEditForm","title","genre","loading","setLoading","message","setMessage","token","logout","navigate","fetchMovies","res","get","data","_unused","handleDelete","id","window","confirm","delete","concat","filter","m","_id","_unused2","startEdit","movie","cancelEdit","handleUpdate","e","preventDefault","put","map","_objectSpread","_unused3","className","children","onClick","style","marginBottom","onSubmit","display","value","onChange","target","required","type","disabled","marginTop","link","location","origin","navigator","clipboard","writeText","alert","marginLeft","color","textDecoration","embedCode"],"sources":["/data/data/com.termux/files/home/Movie_Recommendation_App/movie-frontend/src/pages/MovieList.jsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport api, { setAuthToken } from '../services/api';\nimport AuthContext from '../context/AuthContext';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function MovieList() {\n  const [movies, setMovies] = useState([]);\n  const [editingId, setEditingId] = useState(null);\n  const [editForm, setEditForm] = useState({ title: '', genre: '' });\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const { token, logout } = useContext(AuthContext);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (token) {\n      setAuthToken(token);\n      fetchMovies();\n    } else {\n      navigate('/login');\n    }\n  }, [token]);\n\n  const fetchMovies = async () => {\n    setLoading(true);\n    try {\n      const res = await api.get('/movies/all');\n      setMovies(res.data.movies || []);\n    } catch {\n      setMessage('Failed to fetch movies');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async (id) => {\n    if (!window.confirm('Delete this movie?')) return;\n    try {\n      await api.delete(`/movies/${id}`);\n      setMovies(movies.filter((m) => m._id !== id));\n      setMessage('Movie deleted successfully');\n    } catch {\n      setMessage('Delete failed');\n    }\n  };\n\n  const startEdit = (movie) => {\n    setEditingId(movie._id);\n    setEditForm({ title: movie.title, genre: movie.genre });\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditForm({ title: '', genre: '' });\n    setMessage('');\n  };\n\n  const handleUpdate = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      await api.put(`/movies/${editingId}`, editForm);\n      setMovies(\n        movies.map((m) =>\n          m._id === editingId ? { ...m, ...editForm } : m\n        )\n      );\n      cancelEdit();\n      setMessage('Movie updated');\n    } catch {\n      setMessage('Update failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <h2>Movie List</h2>\n      <button onClick={() => navigate('/dashboard')}>Back to Dashboard</button>\n\n      {message && <p>{message}</p>}\n      {loading && <p>Loading...</p>}\n\n      <ul>\n        {movies.map((movie) => (\n          <li key={movie._id} style={{ marginBottom: '1rem' }}>\n            {editingId === movie._id ? (\n              <form onSubmit={handleUpdate} style={{ display: 'inline' }}>\n                <input\n                  value={editForm.title}\n                  onChange={(e) => setEditForm({ ...editForm, title: e.target.value })}\n                  required\n                />\n                <input\n                  value={editForm.genre}\n                  onChange={(e) => setEditForm({ ...editForm, genre: e.target.value })}\n                  required\n                />\n                <button type=\"submit\" disabled={loading}>Save</button>\n                <button type=\"button\" onClick={cancelEdit}>Cancel</button>\n              </form>\n            ) : (\n              <>\n                <strong>{movie.title}</strong> â€” {movie.genre}\n                <div style={{ marginTop: '0.3rem' }}>\n                  <button onClick={() => startEdit(movie)}>Edit</button>\n                  <button onClick={() => handleDelete(movie._id)}>Delete</button>\n                  <button\n                    onClick={() => {\n                      const link = `${window.location.origin}/movie/${movie._id}`;\n                      navigator.clipboard.writeText(link);\n                      alert('Link copied!');\n                    }}\n                    style={{ marginLeft: '8px', color: 'blue', textDecoration: 'underline' }}\n                  >\n                    Share\n                  </button>\n                  <button\n                    onClick={() => {\n                      const embedCode = `<iframe src=\"${window.location.origin}/movie/${movie._id}\" width=\"600\" height=\"400\" frameborder=\"0\" allowfullscreen></iframe>`;\n                      navigator.clipboard.writeText(embedCode);\n                      alert('Embed code copied!');\n                    }}\n                    style={{ marginLeft: '8px', color: 'green', textDecoration: 'underline' }}\n                  >\n                    Copy Embed Code\n                  </button>\n                </div>\n              </>\n            )}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}